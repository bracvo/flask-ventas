{% extends "base.html" %}

{% block title %}Reporte de Ventas{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2 class="mb-4">Reporte de Ventas</h2>
        
        <!-- Resumen General -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stat-card bg-primary text-white">
                    <h5>Ventas Totales</h5>
                    <h3>{{ format_currency(total_sales) }}</h3>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card bg-success text-white">
                    <h5>Producto Más Vendido</h5>
                    <h4>{{ best_selling_product }}</h4>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card bg-info text-white">
                    <h5>Total Transacciones</h5>
                    <h3>{{ stats.total_transactions }}</h3>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card bg-warning text-dark">
                    <h5>Productos Únicos</h5>
                    <h3>{{ stats.unique_products }}</h3>
                </div>
            </div>
        </div>
        
        <!-- Ventas Diarias -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>Ventas Diarias</h5>
            </div>
            <div class="card-body">
                {% if daily_sales.dates %}
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Total Ventas</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for date, total in zip(daily_sales.dates, daily_sales.totals) %}
                            <tr>
                                <td>{{ date }}</td>
                                <td>{{ format_currency(total) }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p class="text-muted">No hay datos de ventas diarias disponibles.</p>
                {% endif %}
            </div>
        </div>
        
        <!-- Ventas por Producto -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>Ventas por Producto</h5>
            </div>
            <div class="card-body">
                {% if sales_by_product %}
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Cantidad Vendida</th>
                                <th>Total Ventas</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in sales_by_product %}
                            <tr>
                                <td>{{ item.product }}</td>
                                <td>{{ item.quantity }}</td>
                                <td>{{ format_currency(item.total) }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p class="text-muted">No hay datos de ventas por producto disponibles.</p>
                {% endif %}
            </div>
        </div>
        
        <div class="text-center">
            <a href="{{ url_for('index') }}" class="btn btn-primary">Agregar Nueva Venta</a>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Ejemplo de gráfico usando Chart.js (opcional)
    document.addEventListener('DOMContentLoaded', function() {
        // Aquí puedes agregar gráficos si lo deseas
        console.log('Página de reporte cargada');
    });
</script>
{% endblock %}